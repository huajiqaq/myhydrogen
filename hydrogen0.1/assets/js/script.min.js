document.querySelectorAll(".datepicker").forEach((function (e) { new Pikaday({ field: e }) }));

var originstr = document.querySelectorAll(".btn")[0].innerText
var is_downloading
var isSupport = 'download' in document.createElement('a');


function download(downurl, name) {
    const a = document.createElement('a');
    a.setAttribute('href', downurl);

    if (isSupport) {
    a.setAttribute('download', name);
    }
    
    a.click();
}

function loading() {

    // 创建 XHR 对象
    const xhr = new XMLHttpRequest();

    // 设置请求方法和 URL
    xhr.open('GET', 'https://gitee.com/api/v5/repos/huaji110/huajicloud/contents/zhihu_hydrogen.html?access_token=abd6732c1c009c3912cbfc683e10dc45');

    // 发送请求
    xhr.send();

    // 请求加载完成,处理响应
    xhr.onload = function () {
        if (xhr.status === 200) {
            // 解析响应内容
            var downjson = JSON.parse(xhr.responseText)
            var downcontent = atob(downjson.content)
            var downurl = downcontent.match(/updateurl=(\S*),updateurl/)[1]
            var appname = "Hydrogen"
            var versionnamme = downcontent.match(/updateversionname=(\S*),updateversionname/)[1]
            var versioncode = downcontent.match(/updateversioncode=(\S*),updateversioncode/)[1]
            var name = appname + "_" + versionnamme + "_" + versioncode + ".apk"
            download(downurl, name)
        }
    }

    // 请求错误处理
    xhr.onerror = function () {
        console.log('Request Error...');
    }
}